(()=>{(()=>{"use strict";var Le={2380:(P,M,g)=>{var I=g(9451),o=g(5184);function k(){const s=new I.JeP({antialias:!0,autoClear:!0,stencil:!1,depth:!0});return s.shadowMap.enabled=!0,s.sortObjects=!1,s.info.autoReset=!1,s.shadowMap.type=o.Wk7,s.outputColorSpace=o.Zr2,s.shadowsUpdate=()=>{s.shadowMap.autoUpdate||(s.shadowMap.needsUpdate=!0)},s}class Z{constructor({container:n,camera:e,scene:i,renderer:d,renderer3D:p,labelRenderer:c,loop:r}=scope){this.container=n,this.camera=e,this.scene=i,this.renderer=d,this.labelRenderer=c,this.effectComposer=r.effectComposer,this.isPortrait=window.matchMedia("(orientation: portrait)").matches,this.setSize(),window.addEventListener("resize",this.setSize.bind(this))}setSize(){this.camera.aspect=this.container.clientWidth/this.container.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.effectComposer.setSize(this.container.clientWidth,this.container.clientHeight),this.labelRenderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.isPortrait=window.matchMedia("(orientation: portrait)").matches}}var W=g(3737),z=g(6174),j=g(5271),ne=g(7067),ue=g(9946);class ye{constructor(n,e,i){this.renderer=n,this.scene=e,this.camera=i,this.passes={};let d=!1;if(this.renderer.capabilities.isWebGL2){const r=this.renderer.getDrawingBufferSize(new o.I9Y),b=Math.trunc(this.renderer.capabilities.maxSamples/2),l=new o.VCu;l.magFilter=o.hxR,l.minFilter=o.hxR,l.format=o.zdS,l.type=o.RQf;const w=new o.nWS(r.width,r.height,{samples:b,depthTexture:l});this.composer=new W.s(this.renderer,w)}else this.composer=new W.s(this.renderer),d=!0;this.setPixelRatio(Math.min(window.devicePixelRatio,2));const p=new z.A(this.scene,this.camera);p.name="ScenePass",this.composer.addPass(p),this.fxaaPass=new j.p(ne.o),this.fxaaPass.name="FXAA";const c=this.renderer.getPixelRatio();this.fxaaPass.material.uniforms.resolution.value.x=1/(this.renderer.domElement.offsetWidth*c),this.fxaaPass.material.uniforms.resolution.value.y=1/(this.renderer.domElement.offsetHeight*c),this.fxaaPass.enabled=d,this.composer.addPass(this.fxaaPass),this.copyPass=new j.p(ue.Z),this.copyPass.name="CopyPass",this.composer.addPass(this.copyPass),this.position=1}addPass(n,e){this.composer.insertPass(e.effect,this.position),this.passes[n]=e,this.position++}addCopyShader(){this.fxaaPass=new j.p(ne.o),this.fxaaPass.name="FXAA";const n=this.renderer.getPixelRatio();this.fxaaPass.material.uniforms.resolution.value.x=1/(this.renderer.domElement.offsetWidth*n),this.fxaaPass.material.uniforms.resolution.value.y=1/(this.renderer.domElement.offsetHeight*n),this.fxaaPass.enabled=!1,this.composer.addPass(this.fxaaPass),this.copyPass=new j.p(ue.Z),this.copyPass.name="CopyPass",this.composer.addPass(this.copyPass)}passToggle(n,e){this.passes[n]&&(this.passes[n].enabled=e)}getPass(n){return this.passes[n]}setPixelRatio(n){this.composer.setPixelRatio(n)}setSize(n,e){this.composer.setSize(n,e)}render(n){this.composer.render(n)}disableAll(){Object.values(this.passes).forEach(n=>n.active=!1)}}class qe{constructor({camera:n,scene:e,renderer:i,renderer3D:d,labelRenderer:p}=scope){this.camera=n,this.scene=e,this.renderer=i,this.renderer3D=d,this.effectComposer=new ye(this.renderer,this.scene,this.camera),this.labelRenderer=p,this.updatables=[],this.clock=new o.zD7,this.delta=0}start(){this.renderer.setAnimationLoop(()=>{this.renderer.info.reset(),this.delta=this.clock.getDelta(),this.tick(),this.labelRenderer.render(this.scene,this.camera),this.effectComposer.composer.render(this.delta)})}tick(){this.updatables.forEach(n=>{n.tick(this.delta)})}stop(){this.renderer.setAnimationLoop(null)}add(n){this.updatables.push(n)}remove(n){this.updatables=this.updatables.filter(e=>e!==n)}}var Q=function(s,n){n===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=s,this.domElement=n,this.enabled=!0,this.enableSetAngle=!0,this.target=new o.Pq0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.polarCameraCorrection=0,this.minPan=void 0,this.maxPan=void 0,this.rotationAndPan=!1,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:o.kBv.ROTATE,MIDDLE:o.kBv.DOLLY,RIGHT:o.kBv.PAN},this.touches={ONE:o.wtR.ROTATE,TWO:o.wtR.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.setPolarAngle=function(t){N=!0,l.phi=t,e.update()},this.setAzimuthAngle=function(t){N=!0,l.theta=t,e.update()},this.setAzimuthDeltaAngle=function(t){N=!0,w.theta=t,e.update()},this.getAzimuthalAngle=function(){return l.theta},this.listenToKeyEvents=function(t){t.addEventListener("keydown",Ae),this._domElementKeyEvents=t},this.dollyInCamera=function(){de(B()),e.update()},this.dollyOutCamera=function(){se(B()),e.update()},this.callbackFunctions={onDolly:void 0},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(i),e.update(),r=c.NONE},this.update=function(){var t=new o.Pq0,E=new o.PTz().setFromUnitVectors(s.up,new o.Pq0(0,1,0)),L=E.clone().invert(),S=new o.Pq0,oe=new o.PTz,re=2*Math.PI;return function(){var _e=e.object.position;t.copy(_e).sub(e.target),t.applyQuaternion(E),N||l.setFromVector3(t),e.autoRotate&&r===c.NONE&&G($()),e.enableDamping?(l.theta+=w.theta*e.dampingFactor,l.phi+=w.phi*e.dampingFactor):(l.theta+=w.theta,l.phi+=w.phi);var _=e.minAzimuthAngle,q=e.maxAzimuthAngle;return isFinite(_)&&isFinite(q)&&(_<-Math.PI?_+=re:_>Math.PI&&(_-=re),q<-Math.PI?q+=re:q>Math.PI&&(q-=re),_<=q?l.theta=Math.max(_,Math.min(q,l.theta)):l.theta=l.theta>(_+q)/2?Math.max(_,l.theta):Math.min(q,l.theta)),l.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=T,l.radius=Math.max(e.minDistance,Math.min(e.maxDistance,l.radius)),e.enableDamping===!0?e.target.addScaledVector(O,e.dampingFactor):e.target.add(O),e.minPan&&e.maxPan&&e.target.clamp(e.minPan,e.maxPan),t.setFromSpherical(l),t.applyQuaternion(L),_e.copy(e.target).add(t),e.object.lookAt(e.target.x,e.target.y+e.polarCameraCorrection,e.target.z),e.enableDamping===!0?(w.theta*=1-e.dampingFactor,w.phi*=1-e.dampingFactor,O.multiplyScalar(1-e.dampingFactor)):(w.set(0,0,0),O.set(0,0,0)),T=1,N=!1,u||S.distanceToSquared(e.object.position)>b||8*(1-oe.dot(e.object.quaternion))>b?(e.dispatchEvent(i),S.copy(e.object.position),oe.copy(e.object.quaternion),u=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Be,!1),e.domElement.removeEventListener("pointerdown",Fe,!1),e.domElement.removeEventListener("wheel",He,!1),e.domElement.removeEventListener("touchstart",Xe,!1),e.domElement.removeEventListener("touchend",Ue,!1),e.domElement.removeEventListener("touchmove",Ze,!1),e.domElement.ownerDocument.removeEventListener("pointermove",Oe,!1),e.domElement.ownerDocument.removeEventListener("pointerup",Te,!1),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",Ae)};var e=this,i={type:"change"},d={type:"start"},p={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},r=c.NONE,b=1e-6,l=new o.YHV,w=new o.YHV,T=1,O=new o.Pq0,u=!1,h=new o.I9Y,y=new o.I9Y,m=new o.I9Y,v=new o.I9Y,A=new o.I9Y,D=new o.I9Y,F=new o.I9Y,H=new o.I9Y,U=new o.I9Y,N=!1;function $(){return 2*Math.PI/60/60*e.autoRotateSpeed}function B(){return Math.pow(.95,e.zoomSpeed)}function G(t){w.theta-=t}function ee(t){w.phi-=t}var te=function(){var t=new o.Pq0;return function(L,S){t.setFromMatrixColumn(S,0),t.multiplyScalar(-L),O.add(t)}}(),le=function(){var t=new o.Pq0;return function(L,S){e.screenSpacePanning===!0?t.setFromMatrixColumn(S,1):(t.setFromMatrixColumn(S,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(L),O.add(t)}}(),V=function(){var t=new o.Pq0;return function(L,S){var oe=e.domElement;if(e.object.isPerspectiveCamera){var re=e.object.position;t.copy(re).sub(e.target);var be=t.length();be*=Math.tan(e.object.fov/2*Math.PI/180),te(2*L*be/oe.clientHeight,e.object.matrix),le(2*S*be/oe.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(te(L*(e.object.right-e.object.left)/e.object.zoom/oe.clientWidth,e.object.matrix),le(S*(e.object.top-e.object.bottom)/e.object.zoom/oe.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function se(t){e.object.isPerspectiveCamera?(T/=t,e.enableSetAngle&&e.setPolarAngle(e.getPolarAngle()*t),e.callbackFunctions.onDolly!==void 0&&e.callbackFunctions.onDolly()):e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*t)),e.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function de(t){e.object.isPerspectiveCamera?(T*=t,e.enableSetAngle&&e.setPolarAngle(e.getPolarAngle()/t),e.callbackFunctions.onDolly!==void 0&&e.callbackFunctions.onDolly()):e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/t)),e.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function he(t){h.set(t.clientX,t.clientY)}function me(t){F.set(t.clientX,t.clientY)}function ie(t){v.set(t.clientX,t.clientY)}function fe(t){y.set(t.clientX,t.clientY),m.subVectors(y,h).multiplyScalar(e.rotateSpeed);var E=e.domElement;G(2*Math.PI*m.x/E.clientHeight),ee(2*Math.PI*m.y/E.clientHeight),h.copy(y),e.update()}function ge(t){H.set(t.clientX,t.clientY),U.subVectors(H,F),U.y>0?se(B()):U.y<0&&de(B()),F.copy(H),e.update()}function a(t){A.set(t.clientX,t.clientY),D.subVectors(A,v).multiplyScalar(e.panSpeed),V(D.x,D.y),v.copy(A),e.update()}function f(){}function x(t){t.deltaY<0?de(B()):t.deltaY>0&&se(B()),e.update()}function C(t){var E=!1;switch(t.keyCode){case e.keys.UP:V(0,e.keyPanSpeed),E=!0;break;case e.keys.BOTTOM:V(0,-e.keyPanSpeed),E=!0;break;case e.keys.LEFT:V(e.keyPanSpeed,0),E=!0;break;case e.keys.RIGHT:V(-e.keyPanSpeed,0),E=!0;break}E&&(t.preventDefault(),e.update())}function Y(t){if(t.touches.length==1)h.set(t.touches[0].pageX,t.touches[0].pageY);else{var E=.5*(t.touches[0].pageX+t.touches[1].pageX),L=.5*(t.touches[0].pageY+t.touches[1].pageY);h.set(E,L)}}function X(t){if(t.touches.length==1)v.set(t.touches[0].pageX,t.touches[0].pageY);else{var E=.5*(t.touches[0].pageX+t.touches[1].pageX),L=.5*(t.touches[0].pageY+t.touches[1].pageY);v.set(E,L)}}function K(t){var E=t.touches[0].pageX-t.touches[1].pageX,L=t.touches[0].pageY-t.touches[1].pageY,S=Math.sqrt(E*E+L*L);F.set(0,S)}function Ne(t){e.enableZoom&&K(t),e.enablePan&&X(t)}function pt(t){e.enableZoom&&K(t),e.enableRotate&&Y(t)}function Ye(t){if(t.touches.length==1)y.set(t.touches[0].pageX,t.touches[0].pageY);else{var E=.5*(t.touches[0].pageX+t.touches[1].pageX),L=.5*(t.touches[0].pageY+t.touches[1].pageY);y.set(E,L)}m.subVectors(y,h).multiplyScalar(e.rotateSpeed);var S=e.domElement;G(2*Math.PI*m.x/S.clientHeight),ee(2*Math.PI*m.y/S.clientHeight),h.copy(y)}function ze(t){if(t.touches.length==1)A.set(t.touches[0].pageX,t.touches[0].pageY);else{var E=.5*(t.touches[0].pageX+t.touches[1].pageX),L=.5*(t.touches[0].pageY+t.touches[1].pageY);A.set(E,L)}D.subVectors(A,v).multiplyScalar(e.panSpeed),V(D.x,D.y),v.copy(A)}function Ie(t){var E=t.touches[0].pageX-t.touches[1].pageX,L=t.touches[0].pageY-t.touches[1].pageY,S=Math.sqrt(E*E+L*L);H.set(0,S),U.set(0,Math.pow(H.y/F.y,e.zoomSpeed)),se(U.y),F.copy(H)}function mt(t){e.enableZoom&&Ie(t),e.enablePan&&!e.rotationAndPan&&ze(t)}function ft(t){e.enableZoom&&Ie(t),e.enableRotate&&Ye(t)}function Ct(){}function Fe(t){if(e.enabled!==!1)switch(t.pointerType){case"mouse":case"pen":gt(t);break}}function Oe(t){if(e.enabled!==!1)switch(t.pointerType){case"mouse":case"pen":bt(t);break}}function Te(t){switch(t.pointerType){case"mouse":case"pen":yt(t);break}}function gt(t){t.preventDefault(),e.domElement.focus?e.domElement.focus():window.focus();var E;switch(t.button){case 0:E=e.mouseButtons.LEFT;break;case 1:E=e.mouseButtons.MIDDLE;break;case 2:E=e.mouseButtons.RIGHT;break;default:E=-1}switch(E){case o.kBv.DOLLY:if(e.enableZoom===!1)return;me(t),r=c.DOLLY;break;case o.kBv.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;ie(t),r=c.PAN}else{if(e.enableRotate===!1)return;he(t),e.rotationAndPan&&ie(t),r=c.ROTATE}break;case o.kBv.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;he(t),r=c.ROTATE}else{if(e.enablePan===!1)return;ie(t),r=c.PAN}break;default:r=c.NONE}r!==c.NONE&&(e.domElement.ownerDocument.addEventListener("pointermove",Oe,!1),e.domElement.ownerDocument.addEventListener("pointerup",Te,!1),e.dispatchEvent(d))}function bt(t){if(e.enabled!==!1)switch(t.preventDefault(),e.rotationAndPan&&(t.clientX!==v.x&&(r=c.ROTATE),(t.clientY>v.y+20||t.clientY<v.y-20)&&(r=c.PAN)),r){case c.ROTATE:if(e.enableRotate===!1)return;fe(t);break;case c.DOLLY:if(e.enableZoom===!1)return;ge(t);break;case c.PAN:if(e.enablePan===!1)return;a(t);break}}function yt(t){e.domElement.ownerDocument.removeEventListener("pointermove",Oe,!1),e.domElement.ownerDocument.removeEventListener("pointerup",Te,!1),e.enabled!==!1&&(e.dispatchEvent(p),r=c.NONE)}function He(t){e.enabled===!1||e.enableZoom===!1||r!==c.NONE&&r!==c.ROTATE||(t.preventDefault(),t.stopPropagation(),e.dispatchEvent(d),x(t),e.dispatchEvent(p))}function Ae(t){e.enabled===!1||e.enableKeys===!1||e.enablePan===!1||C(t)}function Xe(t){if(e.enabled!==!1){switch(t.preventDefault(),t.touches.length){case 1:switch(e.touches.ONE){case o.wtR.ROTATE:if(e.enableRotate===!1)return;Y(t),e.rotationAndPan&&X(t),r=c.TOUCH_ROTATE;break;case o.wtR.PAN:if(e.enablePan===!1)return;X(t),r=c.TOUCH_PAN;break;default:r=c.NONE}break;case 2:switch(e.touches.TWO){case o.wtR.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ne(t),r=c.TOUCH_DOLLY_PAN;break;case o.wtR.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;pt(t),r=c.TOUCH_DOLLY_ROTATE;break;default:r=c.NONE}break;default:r=c.NONE}r!==c.NONE&&e.dispatchEvent(d)}}function Ze(t){if(e.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),e.rotationAndPan&&t.touches.length===1&&(t.touches[0].pageX!==v.x&&(r=c.TOUCH_ROTATE),(t.touches[0].pageY>v.y+20||t.touches[0].pageY<v.y-20)&&(r=c.TOUCH_PAN)),r){case c.TOUCH_ROTATE:if(e.enableRotate===!1)return;Ye(t),e.update();break;case c.TOUCH_PAN:if(e.enablePan===!1)return;ze(t),e.update();break;case c.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;mt(t),e.update();break;case c.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;ft(t),e.update();break;default:r=c.NONE}}function Ue(t){e.enabled!==!1&&(e.dispatchEvent(p),r=c.NONE)}function Be(t){e.enabled!==!1&&t.preventDefault()}e.domElement.addEventListener("contextmenu",Be,!1),e.domElement.addEventListener("pointerdown",Fe,!1),e.domElement.addEventListener("wheel",He,!1),e.domElement.addEventListener("touchstart",Xe,!1),e.domElement.addEventListener("touchend",Ue,!1),e.domElement.addEventListener("touchmove",Ze,!1),e.domElement.addEventListener("keydown",Ae,!1),this.update()};Q.prototype=Object.create(o.Qev.prototype),Q.prototype.constructor=Q;var Ee=function(s,n){Q.call(this,s,n),this.screenSpacePanning=!1,this.mouseButtons.LEFT=o.kBv.PAN,this.mouseButtons.RIGHT=o.kBv.ROTATE,this.touches.ONE=o.wtR.PAN,this.touches.TWO=o.wtR.DOLLY_ROTATE};Ee.prototype=Object.create(o.Qev.prototype),Ee.prototype.constructor=Ee;var pe=function(s,n){n===void 0&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');var e=this,i={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=s,this.domElement=n,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:o.kBv.ROTATE,MIDDLE:o.kBv.ZOOM,RIGHT:o.kBv.PAN},this.target=new o.Pq0;var d=1e-6,p=new o.Pq0,c=1,r=i.NONE,b=i.NONE,l=new o.Pq0,w=new o.I9Y,T=new o.I9Y,O=new o.Pq0,u=0,h=new o.I9Y,y=new o.I9Y,m=0,v=0,A=new o.I9Y,D=new o.I9Y;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var F={type:"change"},H={type:"start"},U={type:"end"};this.handleResize=function(){var a=e.domElement.getBoundingClientRect(),f=e.domElement.ownerDocument.documentElement;e.screen.left=a.left+window.pageXOffset-f.clientLeft,e.screen.top=a.top+window.pageYOffset-f.clientTop,e.screen.width=a.width,e.screen.height=a.height};var N=function(){var a=new o.I9Y;return function(x,C){return a.set((x-e.screen.left)/e.screen.width,(C-e.screen.top)/e.screen.height),a}}(),$=function(){var a=new o.I9Y;return function(x,C){return a.set((x-e.screen.width*.5-e.screen.left)/(e.screen.width*.5),(e.screen.height+2*(e.screen.top-C))/e.screen.width),a}}();this.rotateCamera=function(){var a=new o.Pq0,f=new o.PTz,x=new o.Pq0,C=new o.Pq0,Y=new o.Pq0,X=new o.Pq0,K;return function(){X.set(T.x-w.x,T.y-w.y,0),K=X.length(),K?(l.copy(e.object.position).sub(e.target),x.copy(l).normalize(),C.copy(e.object.up).normalize(),Y.crossVectors(C,x).normalize(),C.setLength(T.y-w.y),Y.setLength(T.x-w.x),X.copy(C.add(Y)),a.crossVectors(X,l).normalize(),K*=e.rotateSpeed,f.setFromAxisAngle(a,K),l.applyQuaternion(f),e.object.up.applyQuaternion(f),O.copy(a),u=K):!e.staticMoving&&u&&(u*=Math.sqrt(1-e.dynamicDampingFactor),l.copy(e.object.position).sub(e.target),f.setFromAxisAngle(O,u),l.applyQuaternion(f),e.object.up.applyQuaternion(f)),w.copy(T)}}(),this.zoomCamera=function(a){a&&(h.y=a);var f;r===i.TOUCH_ZOOM_PAN?(f=m/v,m=v,e.object.isPerspectiveCamera?l.multiplyScalar(f):e.object.isOrthographicCamera?(e.object.zoom*=f,e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(f=1+(y.y-h.y)*e.zoomSpeed,f!==1&&f>0&&(e.object.isPerspectiveCamera?l.multiplyScalar(f):e.object.isOrthographicCamera?(e.object.zoom/=f,e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),e.staticMoving?h.copy(y):h.y+=(y.y-h.y)*this.dynamicDampingFactor)},this.panCamera=function(){var a=new o.I9Y,f=new o.Pq0,x=new o.Pq0;return function(){if(a.copy(D).sub(A),a.lengthSq()){if(e.object.isOrthographicCamera){var Y=(e.object.right-e.object.left)/e.object.zoom/e.domElement.clientWidth,X=(e.object.top-e.object.bottom)/e.object.zoom/e.domElement.clientWidth;a.x*=Y,a.y*=X}a.multiplyScalar(l.length()*e.panSpeed),x.copy(l).cross(e.object.up).setLength(a.x),x.add(f.copy(e.object.up).setLength(a.y)),e.object.position.add(x),e.target.add(x),e.staticMoving?A.copy(D):A.add(a.subVectors(D,A).multiplyScalar(e.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!e.noZoom||!e.noPan)&&(l.lengthSq()>e.maxDistance*e.maxDistance&&(e.object.position.addVectors(e.target,l.setLength(e.maxDistance)),h.copy(y)),l.lengthSq()<e.minDistance*e.minDistance&&(e.object.position.addVectors(e.target,l.setLength(e.minDistance)),h.copy(y)))},this.update=function(){l.subVectors(e.object.position,e.target),e.noRotate||e.rotateCamera(),e.noZoom||e.zoomCamera(),e.noPan||e.panCamera(),e.object.position.addVectors(e.target,l),e.object.isPerspectiveCamera?(e.checkDistances(),e.object.lookAt(e.target),p.distanceToSquared(e.object.position)>d&&(e.dispatchEvent(F),p.copy(e.object.position))):e.object.isOrthographicCamera?(e.object.lookAt(e.target),(p.distanceToSquared(e.object.position)>d||c!==e.object.zoom)&&(e.dispatchEvent(F),p.copy(e.object.position),c=e.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){r=i.NONE,b=i.NONE,e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.up.copy(e.up0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),l.subVectors(e.object.position,e.target),e.object.lookAt(e.target),e.dispatchEvent(F),p.copy(e.object.position),c=e.object.zoom};function B(a){if(e.enabled!==!1)switch(a.pointerType){case"mouse":case"pen":V(a);break}}function G(a){if(e.enabled!==!1)switch(a.pointerType){case"mouse":case"pen":se(a);break}}function ee(a){if(e.enabled!==!1)switch(a.pointerType){case"mouse":case"pen":de(a);break}}function te(a){e.enabled!==!1&&(window.removeEventListener("keydown",te),b===i.NONE&&(a.keyCode===e.keys[i.ROTATE]&&!e.noRotate?b=i.ROTATE:a.keyCode===e.keys[i.ZOOM]&&!e.noZoom?b=i.ZOOM:a.keyCode===e.keys[i.PAN]&&!e.noPan&&(b=i.PAN)))}function le(){e.enabled!==!1&&(b=i.NONE,window.addEventListener("keydown",te,!1))}function V(a){if(a.preventDefault(),a.stopPropagation(),r===i.NONE)switch(a.button){case e.mouseButtons.LEFT:r=i.ROTATE;break;case e.mouseButtons.MIDDLE:r=i.ZOOM;break;case e.mouseButtons.RIGHT:r=i.PAN;break;default:r=i.NONE}var f=b!==i.NONE?b:r;f===i.ROTATE&&!e.noRotate?(T.copy($(a.pageX,a.pageY)),w.copy(T)):f===i.ZOOM&&!e.noZoom?(h.copy(N(a.pageX,a.pageY)),y.copy(h)):f===i.PAN&&!e.noPan&&(A.copy(N(a.pageX,a.pageY)),D.copy(A)),e.domElement.ownerDocument.addEventListener("pointermove",G,!1),e.domElement.ownerDocument.addEventListener("pointerup",ee,!1),e.dispatchEvent(H)}function se(a){if(e.enabled!==!1){a.preventDefault(),a.stopPropagation();var f=b!==i.NONE?b:r;f===i.ROTATE&&!e.noRotate?(w.copy(T),T.copy($(a.pageX,a.pageY))):f===i.ZOOM&&!e.noZoom?y.copy(N(a.pageX,a.pageY)):f===i.PAN&&!e.noPan&&D.copy(N(a.pageX,a.pageY))}}function de(a){e.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),r=i.NONE,e.domElement.ownerDocument.removeEventListener("pointermove",G),e.domElement.ownerDocument.removeEventListener("pointerup",ee),e.dispatchEvent(U))}function he(a){if(e.enabled!==!1&&e.noZoom!==!0){switch(a.preventDefault(),a.stopPropagation(),a.deltaMode){case 2:h.y-=a.deltaY*.025;break;case 1:h.y-=a.deltaY*.01;break;default:h.y-=a.deltaY*25e-5;break}e.dispatchEvent(H),e.dispatchEvent(U)}}function me(a){if(e.enabled!==!1){switch(a.preventDefault(),a.touches.length){case 1:r=i.TOUCH_ROTATE,T.copy($(a.touches[0].pageX,a.touches[0].pageY)),w.copy(T);break;default:r=i.TOUCH_ZOOM_PAN;var f=a.touches[0].pageX-a.touches[1].pageX,x=a.touches[0].pageY-a.touches[1].pageY;v=m=Math.sqrt(f*f+x*x);var C=(a.touches[0].pageX+a.touches[1].pageX)/2,Y=(a.touches[0].pageY+a.touches[1].pageY)/2;A.copy(N(C,Y)),D.copy(A);break}e.dispatchEvent(H)}}function ie(a){if(e.enabled!==!1)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:w.copy(T),T.copy($(a.touches[0].pageX,a.touches[0].pageY));break;default:var f=a.touches[0].pageX-a.touches[1].pageX,x=a.touches[0].pageY-a.touches[1].pageY;v=Math.sqrt(f*f+x*x);var C=(a.touches[0].pageX+a.touches[1].pageX)/2,Y=(a.touches[0].pageY+a.touches[1].pageY)/2;D.copy(N(C,Y));break}}function fe(a){if(e.enabled!==!1){switch(a.touches.length){case 0:r=i.NONE;break;case 1:r=i.TOUCH_ROTATE,T.copy($(a.touches[0].pageX,a.touches[0].pageY)),w.copy(T);break}e.dispatchEvent(U)}}function ge(a){e.enabled!==!1&&a.preventDefault()}this.dispose=function(){e.domElement.removeEventListener("contextmenu",ge,!1),e.domElement.removeEventListener("pointerdown",B,!1),e.domElement.removeEventListener("wheel",he,!1),e.domElement.removeEventListener("touchstart",me,!1),e.domElement.removeEventListener("touchend",fe,!1),e.domElement.removeEventListener("touchmove",ie,!1),e.domElement.ownerDocument.removeEventListener("pointermove",G,!1),e.domElement.ownerDocument.removeEventListener("pointerup",ee,!1),window.removeEventListener("keydown",te,!1),window.removeEventListener("keyup",le,!1)},this.domElement.addEventListener("contextmenu",ge,!1),this.domElement.addEventListener("pointerdown",B,!1),this.domElement.addEventListener("wheel",he,!1),this.domElement.addEventListener("touchstart",me,!1),this.domElement.addEventListener("touchend",fe,!1),this.domElement.addEventListener("touchmove",ie,!1),this.domElement.ownerDocument.addEventListener("pointermove",G,!1),this.domElement.ownerDocument.addEventListener("pointerup",ee,!1),window.addEventListener("keydown",te,!1),window.addEventListener("keyup",le,!1),this.handleResize(),this.update()};pe.prototype=Object.create(o.Qev.prototype),pe.prototype.constructor=pe;let ce=[];function We(){const s=new Q(this.camera,this.container),n=new pe(this.camera,this.container);return n.noRotate=!0,n.noPan=!0,n.noZoom=!1,n.zoomSpeed=1.5,n.dynamicDampingFactor=.2,n.maxDistance=1/0,n.minDistance=0,s.mouseButtons={LEFT:o.kBv.ROTATE,MIDDLE:o.kBv.DOLLY,RIGHT:o.kBv.PAN},s.touches={ONE:o.wtR.ROTATE,TWO:o.wtR.DOLLY_PAN},s.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},s.enabled=!0,s.rotationAndPan=!1,s.screenSpacePanning=!1,s.enablePan=!0,s.enableZoom=!1,s.enableSetAngle=!1,s.minPolarAngle=0,s.maxPolarAngle=Math.PI,s.target.set(1139.77,0,-1134.95),s.enableDamping=!0,s.dampingFactor=.1,s.tick=()=>{s.update(),n.target.copy(s.target),n.update()},s.addChangeCallback=e=>ce.push(e),s.removeChangeCallBack=e=>ce=ce.filter(i=>i!==e),s.addEventListener("change",()=>ce.forEach(e=>e.update())),s.addEventListener("end",()=>ce.forEach(e=>e.updateEnd())),s.getTrackBall=()=>n,s}function Et(){const s=new TrackballControls(this.camera,this.container);return s.noRotate=!0,s.noPan=!0,s.noZoom=!1,s.zoomSpeed=1.5,s.dynamicDampingFactor=.2,s}function Ge(){const s=new o.$p8("#ffffff",1);return s.name="AmbientLight",s}function Ve(){const s=new o.ZyN("#ffffff",2.3);s.castShadow=!0,s.name="DirectionalLight",s.shadow.mapSize.width=512,s.shadow.mapSize.height=512,s.shadow.camera.near=.5,s.shadow.camera.far=2e3,s.shadow.normalBias=0,s.position.set(200,200,0);const n=150;return s.shadow.camera.right=n,s.shadow.camera.left=-n,s.shadow.camera.top=n,s.shadow.camera.bottom=-n,s}let J=null,xe=null;const we=new o.I9Y,wt=new o.I9Y,vt=new o.I9Y;let ve=!1,Pe=!1;const ke=new o.I9Y;function Pt(s,n){const e=new Raycaster,i=window.innerWidth-n.clientWidth;return n.addEventListener("pointermove",d=>{Pe=ve,ke.set(d.clientX,d.clientY),we.x=(d.clientX-i)/n.clientWidth*2-1,we.y=-(d.clientY/n.clientHeight)*2+1}),n.addEventListener("pointerup",d=>{ve=!1,Pe=!1}),n.addEventListener("pointerdown",d=>{ve=!0}),e.addIntersection=d=>{J.find(c=>c===d)||J.push(d)},e.addIntersectionFunction=d=>{xe.push(d)},e.clearIntersection=()=>{J=[]},e.removeIntersection=d=>{J=J.filter(p=>p!==d)},e.lunchIntersectionFunction=d=>{xe.forEach(p=>p(d))},e.intersect=()=>{e.setFromCamera(we,s);let d=e.intersectObjects(J,!1);e.lunchIntersectionFunction({isDrag:Pe,object:d[0]})},e.getWindowCursorPosition=()=>ke,e.getAllIntersections=()=>J,e}class Ot extends o.B69{constructor(n=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=n,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new o.I9Y(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&e.element.parentNode!==null&&e.element.parentNode.removeChild(e.element)})})}copy(n,e){return super.copy(n,e),this.element=n.element.cloneNode(!0),this.center=n.center,this}}const ae=new o.Pq0,Se=new o.kn4,Me=new o.kn4,Ce=new o.Pq0,je=new o.Pq0;class Ke{constructor(n={}){const e=this;let i,d,p,c;const r={objects:new WeakMap},b=n.element!==void 0?n.element:document.createElement("div");b.style.overflow="hidden",this.domElement=b,this.getSize=function(){return{width:i,height:d}},this.render=function(u,h){u.matrixWorldAutoUpdate===!0&&u.updateMatrixWorld(),h.parent===null&&h.matrixWorldAutoUpdate===!0&&h.updateMatrixWorld(),Se.copy(h.matrixWorldInverse),Me.multiplyMatrices(h.projectionMatrix,Se),l(u,u,h),O(u)},this.setSize=function(u,h){i=u,d=h,p=i/2,c=d/2,b.style.width=u+"px",b.style.height=h+"px"};function l(u,h,y){if(u.isCSS2DObject){ae.setFromMatrixPosition(u.matrixWorld),ae.applyMatrix4(Me);const m=u.visible===!0&&ae.z>=-1&&ae.z<=1&&u.layers.test(y.layers)===!0;if(u.element.style.display=m===!0?"":"none",m===!0){u.onBeforeRender(e,h,y);const A=u.element,D=u.userData.zoom||1;A.style.transform="translate("+-100*u.center.x+"%,"+-100*u.center.y+"%)translate("+(ae.x*p+p)+"px,"+(-ae.y*c+c)+"px)scale("+D+", "+D+")",A.parentNode!==b&&b.appendChild(A),u.onAfterRender(e,h,y)}const v={distanceToCameraSquared:w(y,u)};r.objects.set(u,v)}for(let m=0,v=u.children.length;m<v;m++)l(u.children[m],h,y)}function w(u,h){return Ce.setFromMatrixPosition(u.matrixWorld),je.setFromMatrixPosition(h.matrixWorld),Ce.distanceToSquared(je)}function T(u){const h=[];return u.traverse(function(y){y.isCSS2DObject&&h.push(y)}),h}function O(u){const h=T(u).sort(function(m,v){if(m.renderOrder!==v.renderOrder)return v.renderOrder-m.renderOrder;const A=r.objects.get(m).distanceToCameraSquared,D=r.objects.get(v).distanceToCameraSquared;return A-D}),y=h.length;for(let m=0,v=h.length;m<v;m++)h[m].element.style.zIndex=y-m}}}var Qe=g(4371),Je=g(1004),$e=g(7098),et=g(7594),tt=g(2935),ot=g(9341),nt=g(5300);const Tt=new nt.P,At=new o.iyt,at=new o.V9B({transparent:!0,opacity:1});class st{constructor(n){this.world=n,this.opacity=1,this.url="https://dreamstest.bmby.com/Yagur_simplify/tileset.json?v=888888",this.tilesRenderer=new Qe.d(this.url);const e=document.querySelector(".error-target"),i=document.querySelector(".error-target-output");e.addEventListener("input",O=>{this.tilesRenderer.errorTarget=Number(O.target.value),i.textContent=this.tilesRenderer.errorTarget});const d=new o.YJl;d.name="surfaceGroup";const p=new o.YJl;p.name="async env",p.position.y=2500,p.add(d);const c=new $e.Z().setDecoderPath("js/libs/gltf/"),r=new tt.p().setTranscoderPath("js/libs/basis/").detectSupport(n.renderer),b=new et.B().setDRACOLoader(c).setKTX2Loader(r).setMeshoptDecoder(ot.f);this.tilesRenderer.manager.addHandler(/\.gltf$/,{parse(...O){return b.parse(...O)}}),this.tilesRenderer.setCamera(n.camera),this.tilesRenderer.setResolutionFromRenderer(n.camera,n.renderer);let l=!1;const w=new Je.r({recenter:!0,up:"z"});w.init(this.tilesRenderer),this.tilesRenderer.registerPlugin(w);let T=!1;this.tilesRenderer.addEventListener("load-tile-set",({tileSet:O})=>{}),this.tilesRenderer.addEventListener("load-model",({scene:O,tile:u})=>{(O.scene?O.scene:O).traverse(y=>{if(y.material){const m=y.material.map;y.material=at.clone(),m&&(m.colorSpace=o.Zr2,m.wrapS=o.GJx,m.wrapT=o.GJx,m.offset.set(0,0),m.repeat.set(1,1),m.anisotropy=2,m.magFilter=o.k6q,m.minFilter=o.$_I,y.material.map=m,y.geometry.computeVertexNormals())}})}),this.tilesRenderer.addEventListener("dispose-model",({scene:O,tile:u})=>{(O.scene?O.scene:O).traverse(y=>{y.isMesh&&(y.geometry.dispose(),y.material.dispose())})}),d.add(this.tilesRenderer.group),n.addToScene(p),n.loop.add(this)}tick(){this.tilesRenderer.update()}}const Lt={},Rt={},Dt={},xt={},kt={},St={};class Mt{constructor(n){this.world=n,document.querySelector(".pips-input").addEventListener("change",i=>{this.group.visible=i.target.checked}),this.group=new Group,this.group.position.y=2800,this.group.visible=!1,this.group.name="Pips",this.surface=new Group,this.surface.matrixAutoUpdate=!1,this.group.add(this.surface),n.addToScene(this.group)}buildPips(){const n=new LineMaterial({linewidth:2,dashed:!1,depthTest:!0,opacity:.9,alphaToCoverage:!0}),e=this.world.tiles.tilesRenderer.ellipsoid,i=this.world.tiles.tilesRenderer.group;pips.features.forEach(d=>{const p=[];if(d.geometry.coordinates.forEach(c=>{const r=MathUtils.degToRad(c[1]),b=MathUtils.degToRad(c[0]),l=new Vector3;e.getCartographicToPosition(r,b,0,l),!isNaN(l.x)&&!isNaN(l.y)&&(l.applyMatrix4(i.matrix),p.push(l))}),p.length){const c=new BufferGeometry().setFromPoints(p),r=new LineGeometry().setPositions(c.getAttribute("position").array),b=new Line2(r,n);this.surface.add(b)}})}}var it=g(8183);const rt=new it.w;function ct(s){return rt.loadAsync(`./assets/models/${s}`)}var lt=(s,n,e)=>new Promise((i,d)=>{var p=b=>{try{r(e.next(b))}catch(l){d(l)}},c=b=>{try{r(e.throw(b))}catch(l){d(l)}},r=b=>b.done?i(b.value):Promise.resolve(b.value).then(p,c);r((e=e.apply(s,n)).next())});class dt{constructor(n){this.world=n,this.files={buivPoly:"Biuv_Poly.fbx",maimPoly:"Maim_Poly.fbx"},this.materialSettings={buivPoly:{color:"#eaff00"},maimPoly:{color:"#0000ff"}},this.group=new o.YJl,this.group.name="Pips model",this.group.position.set(1113.91,-90,-1728.8),this.group.rotation.set(0,Math.PI,0),this.world.addToScene(this.group),this.loadFiles(),document.querySelector(".layer-input.buiv").addEventListener("change",d=>this.selectHandler("buivPoly",d.target.checked)),document.querySelector(".layer-input.maim").addEventListener("change",d=>this.selectHandler("maimPoly",d.target.checked))}selectHandler(n,e){const i=this.group.getObjectByName(n);i&&(i.visible=e)}loadFiles(){return lt(this,null,function*(){for(const[n,e]of Object.entries(this.files)){const i=yield ct(e);i.name=n,i.visible=!1;const d=this.materialSettings[n],p=new o.V9B;Object.entries(d).forEach(([c,r])=>{r.startsWith("#")?p[c].setStyle(r,o.Zr2):p[c]=r}),i.traverse(c=>{c.isMesh&&(c.material=p)}),this.group.add(i)}})}}class ht{constructor(n){this.container=n,this.scene=new o.Z58,this.scene.background=new o.Q1f().setStyle("#000000",o.Zr2),this.camera=new o.ubm(55,1,.1,2e4),this.camera.position.set(790,160,-1208),this.renderer=k(),this.labelRenderer=new Ke,this.ambientLight=Ge(),this.directionalLight=Ve(),this.orbitControls=We.apply(this),this.container.appendChild(this.renderer.domElement),this.container.appendChild(this.labelRenderer.domElement),this.loop=new qe(this),this.resizer=new Z(this),this.tiles=new st(this),this.pipsFile=new dt(this),this.scene.add(this.ambientLight),this.scene.add(this.directionalLight),this.loop.add(this.orbitControls)}render(){this.renderer.render(this.scene,this.camera)}start(){this.loop.start()}stop(){this.loop.stop()}addToScene(n,e){if(this.scene.add(n),e){const i=this.scene.children[e],d=this.scene.children.indexOf(n);i&&(this.scene.children[e]=n,this.scene.children[d]=i)}this.renderer.shadowsUpdate()}addToObject(n,e){const i=this.scene.getObjectByName(n);if(i)i.add(e);else{const d=new o.YJl;d.name=n,d.add(e),this.addToScene(d)}this.renderer.shadowsUpdate()}removeFromScene(n){const e=this.scene.getObjectByName(n.name);e&&(e.removeFromParent(),e.traverse(i=>{i.isMesh&&(i.geometry.dispose(),i.material.dispose())})),this.renderer.shadowsUpdate()}getObject(n){return this.scene.getObjectByName(n)}distance(){return this.camera.position.distanceTo(this.orbitControls.target)}}function ut(){const s=document.querySelector(".scene");window.world=new ht(s),world.start()}ut()}},Re={};function R(P){var M=Re[P];if(M!==void 0)return M.exports;var g=Re[P]={exports:{}};return Le[P](g,g.exports,R),g.exports}R.m=Le,(()=>{var P=[];R.O=(M,g,I,o)=>{if(g){o=o||0;for(var k=P.length;k>0&&P[k-1][2]>o;k--)P[k]=P[k-1];P[k]=[g,I,o];return}for(var Z=1/0,k=0;k<P.length;k++){for(var[g,I,o]=P[k],W=!0,z=0;z<g.length;z++)(o&!1||Z>=o)&&Object.keys(R.O).every(Q=>R.O[Q](g[z]))?g.splice(z--,1):(W=!1,o<Z&&(Z=o));if(W){P.splice(k--,1);var j=I();j!==void 0&&(M=j)}}return M}})(),R.d=(P,M)=>{for(var g in M)R.o(M,g)&&!R.o(P,g)&&Object.defineProperty(P,g,{enumerable:!0,get:M[g]})},R.o=(P,M)=>Object.prototype.hasOwnProperty.call(P,M),(()=>{var P={792:0};R.O.j=I=>P[I]===0;var M=(I,o)=>{var[k,Z,W]=o,z,j,ne=0;if(k.some(ye=>P[ye]!==0)){for(z in Z)R.o(Z,z)&&(R.m[z]=Z[z]);if(W)var ue=W(R)}for(I&&I(o);ne<k.length;ne++)j=k[ne],R.o(P,j)&&P[j]&&P[j][0](),P[j]=0;return R.O(ue)},g=self.webpackChunk=self.webpackChunk||[];g.forEach(M.bind(null,0)),g.push=M.bind(null,g.push.bind(g))})(),R.O(void 0,[911],()=>R(1001));var De=R.O(void 0,[911],()=>R(2380));De=R.O(De)})();})();
